<div class="last-block" *ngIf="((latestBlockNumber|async) || 0) > 0">
  {{latestBlockNumber|async}}
</div>
<div class="blocks" [@blocksAnimation]="latestBlockNumber|async">
  <div class="block-outer" *ngFor="let block$ of blocks|async; trackBy: trackByNumber">
    <ng-container *ngIf="block$|async as block">
      <a class="block-inner" [class.finalized]="block.finalized" [routerLink]="'block/' + block.number">
        <!-- TODO fees and weight visualization -->
        <span class="number">{{block.number}}</span>
        <span class="transaction" *ngFor="let i of block.extrinsics"></span>
        <span class="event" *ngFor="let i of block.events"></span>
      </a>
    </ng-container>
  </div>
</div>
<div><a routerLink="block">View blocks</a></div>
<div><a routerLink="event">View events</a></div>
<div><a routerLink="extrinsic">View extrinsics</a></div>
<div><a routerLink="inherent">View inherents</a></div>
<div><a routerLink="transaction">View transactions</a></div>
<div><a routerLink="runtime">View runtime history</a></div>
<div><a routerLink="log">View logs</a></div>
<div><a routerLink="balances/transfer">View transfers</a></div>
<div>
  <form [formGroup]="substrateRpcUrlForm" (ngSubmit)="submitSubstrateRpcUrl()">
    <mat-form-field appearance="fill" style="width: 300px; margin-right: 10px;">
      <mat-label>{{ns.currentNetwork|async}} node URL</mat-label>
      <input type="text"
             placeholder="Enter URL"
             aria-label="URL"
             matInput
             formControlName="url"
             [matAutocomplete]="substrateUrlOptionsAuto">
      <mat-autocomplete #substrateUrlOptionsAuto="matAutocomplete" (optionSelected)="submitSubstrateRpcUrl()">
        <mat-option *ngFor="let option of pa.substrateRpcUrls|async" [value]="option">
          {{option}}
        </mat-option>
      </mat-autocomplete>
      <span class="mat-select-arrow" style="position: absolute; right: 0; top: 10px;"></span>
    </mat-form-field>
    <button mat-stroked-button color="primary" type="submit" style="margin-right: 10px;">Connect</button>
    <ng-container [ngSwitch]="pa.substrateRpcRegistered|async">
      <ng-container *ngSwitchCase="true">
        <ng-container [ngSwitch]="pa.substrateRpcConnected|async">
          <span *ngSwitchCase="true" style="color: green">(connected)</span>
          <span *ngSwitchCase="false" style="font-style: italic">(connecting)</span>
        </ng-container>
      </ng-container>
      <ng-container *ngSwitchCase="false">
        <span style="color: red;">(connection error)</span>
      </ng-container>
    </ng-container>
  </form>
</div>
<div>
  <form [formGroup]="polkascanWsUrlForm" (ngSubmit)="submitPolkascanWsUrl()">
    <mat-form-field appearance="fill" style="width: 300px; margin-right: 10px;">
      <mat-label>{{ns.currentNetwork|async}} Polkascan URL</mat-label>
      <input type="text"
             placeholder="Enter URL"
             aria-label="URL"
             matInput
             formControlName="url"
             [matAutocomplete]="polkascanWsUrlOptionsAuto">
      <mat-autocomplete #polkascanWsUrlOptionsAuto="matAutocomplete" (optionSelected)="submitPolkascanWsUrl()">
        <mat-option *ngFor="let option of pa.polkascanWsUrls|async" [value]="option">
          {{option}}
        </mat-option>
      </mat-autocomplete>
      <span class="mat-select-arrow" style="position: absolute; right: 0; top: 10px;"></span>
    </mat-form-field>
    <button mat-stroked-button color="primary" type="submit" style="margin-right: 10px;">Connect</button>
    <ng-container [ngSwitch]="pa.polkascanRegistered|async">
      <ng-container *ngSwitchCase="true">
        <ng-container [ngSwitch]="pa.polkascanWsConnected|async">
          <span *ngSwitchCase="true" style="color: green">(connected)</span>
          <span *ngSwitchCase="false" style="font-style: italic">(connecting)</span>
        </ng-container>
      </ng-container>
      <ng-container *ngSwitchCase="false">
        <span style="color: red;">(connection error)</span>
      </ng-container>
    </ng-container>

    <span style="margin-left: 10px; color: red;" *ngIf="(pa.polkascanDataErrors|async)?.length as dataErrorCount">{{ dataErrorCount }} errors</span>
  </form>
</div>
<div><a routerLink="account/12xtAYsRUrmbniiWQqJtECiBQrMn8AypQcXhnQAc6RB6XkLW">Test account</a></div>
